<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      #map-canvas {
        width: 600px;
        height: 400px;
      }
    </style>
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDxTEbJsXwGRW4zDj8fpVsenDMMQGhZhUU&sensor=false">
    </script>
    <script data-main="../../initialize" src="../../../externals/require.js"></script>
    <script type="text/javascript">
      function LayerRepository(aeris) {
        this.aeris = aeris;
        this.layers = {};
      }
      LayerRepository.prototype.getLayer = function(layer) {
        var layer_ = this.layers[layer];
        if (!layer_) {
          layer_ = this.layers[layer] = new this.aeris.maps.layers[layer]();
        }
        return layer_;
      };

      function initialize() {
        require(["aeris/maps/gmaps"], function(aeris) {

          var layerRepo = new LayerRepository(aeris);

          var map = new aeris.maps.gmaps.Map("map-canvas", {
            baseLayer: layerRepo.getLayer('GoogleRoadMap'),
            center: [-34.397, 150.644],
            zoom: 8
          });

          var $baseLayer = $("#base-layer");
          $baseLayer.change(function() {
            var layer = layerRepo.getLayer($baseLayer.val());
            map.layers.setBaseLayer(layer);
          });
        });
      }
    </script>
  </head>
  <body>
    <div id="map-canvas"></div>
    <div>
      <select id="base-layer">
        <option value="GoogleRoadMap" selected="selected">Google Street Map</option>
        <option value="GoogleSatellite">Google Satellite</option>
        <option value="GoogleTerrain">Google Terrain</option>
        <option value="GoogleHybrid">Google Hybrid</option>
        <option value="OSM">OpenStreetMap</option>
      </select>
    </div>
  </body>
</html>
